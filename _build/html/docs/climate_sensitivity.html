

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>12. Climate Sensitivity and Feedback &#8212; Polar Climate Change Home</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/climate_sensitivity';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="13. Radiative Advective Equilibrium (RAE)" href="rae_model.html" />
    <link rel="prev" title="11. Radiative Convective Equilibrium (RCE)" href="rce_model.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/front_page_image.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/front_page_image.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="syllabus.html">1. Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_arctic.html">2. Overview of Arctic and Antarctic</a></li>
<li class="toctree-l1"><a class="reference internal" href="snow.html">3. Snow</a></li>
<li class="toctree-l1"><a class="reference internal" href="permafrost.html">4. Permafrost</a></li>
<li class="toctree-l1"><a class="reference internal" href="glaciers.html">5. Glaciers</a></li>
<li class="toctree-l1"><a class="reference internal" href="sea_ice.html">6. Sea ice</a></li>
<li class="toctree-l1"><a class="reference internal" href="pv_ssw.html">7. Polar Stratospheric Circulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cause_aa.html">8. Causes of Polar Amplification</a></li>
<li class="toctree-l1"><a class="reference internal" href="zero_dim_model.html">9. Zero-dimensional Energy Balance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="layer_model.html">10. Layered Energy Balance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="rce_model.html">11. Radiative Convective Equilibrium (RCE)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">12. Climate Sensitivity and Feedback</a></li>
<li class="toctree-l1"><a class="reference internal" href="rae_model.html">13. Radiative Advective Equilibrium (RAE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="one_dim_ebm.html">One-dimensional Energy Balance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="seasonality.html">Seasonal cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="ice_albedo_ebm.html">Ice Albedo Feedback in EBM</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusive_response.html">Diffusive Response</a></li>
<li class="toctree-l1"><a class="reference internal" href="snowball.html">Snowball Earth</a></li>
<li class="toctree-l1"><a class="reference internal" href="effect_aa.html">Arctic-Midlatitude Linkage</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="history_modelling.html">The History of Climate Modeling</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/climate_sensitivity.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>12. Climate Sensitivity and Feedback</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#radiative-forcing">Radiative forcing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-climate-sensitivity-ecs-without-feedback">Equilibrium climate sensitivity (ECS) without feedback</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#climate-feedback">Climate feedback</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-physical-model-putting-together">The physical model - putting together</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#radiative-kernel-analysis">Radiative kernel analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homework-assignment-x-due-xxx">Homework assignment X (due xxx)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="climate-sensitivity-and-feedback">
<span id="ecs-feedback"></span><h1>12. Climate Sensitivity and Feedback<a class="headerlink" href="#climate-sensitivity-and-feedback" title="Permalink to this heading">#</a></h1>
<section id="radiative-forcing">
<h2>Radiative forcing<a class="headerlink" href="#radiative-forcing" title="Permalink to this heading">#</a></h2>
<p>We start with the radiative forcing in a RCE model. Recall that the instantaneous radiative forcing is the quick change in the TOA energy budget before the climate system begins to adjust.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/hansen_1997_rf.png"><img alt="../_images/hansen_1997_rf.png" src="../_images/hansen_1997_rf.png" style="width: 927.0px; height: 443.0px;" /></a>
</figure>
<p>If we consider the forcing as doubling CO2, we could write the radiative forcing as:</p>
<div class="math notranslate nohighlight" id="equation-my-label61">
<span class="eqno">(61)<a class="headerlink" href="#equation-my-label61" title="Permalink to this equation">#</a></span>\[\Delta R = (ASR_{2xCO2}-OLR_{2xCO2}) - (ASR_{1xCO2}-OLR_{1xCO2}).\]</div>
<p>What is happening after we add more CO2 in the atmosphere?</p>
<ul class="simple">
<li><p>The atmosphere is less efficient at radiating energy away to space (reducing emissivity, right?).</p></li>
<li><p>OLR will decrease</p></li>
<li><p>The climate system will begin gaining energy.</p></li>
</ul>
<p>Now let’s build a RCE model and analyze its radiative forcing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  This code is used just to create the skew-T plot of global, annual mean air temperature</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">metpy.plots</span> <span class="kn">import</span> <span class="n">SkewT</span>
<span class="kn">import</span> <span class="nn">climlab</span>

<span class="c1">#plt.style.use(&#39;dark_background&#39;)</span>

<span class="c1">#  This code is used just to create the skew-T plot of global, annual mean air temperature</span>
<span class="c1">#ncep_url = &quot;http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/ncep.reanalysis.derived/&quot;</span>
<span class="n">ncep_url</span> <span class="o">=</span> <span class="s2">&quot;/Users/yuchiaol_ntuas/Desktop/ebooks/data/&quot;</span>
<span class="c1">#time_coder = xr.coders.CFDatetimeCoder(use_cftime=True)</span>
<span class="n">ncep_air</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span> <span class="n">ncep_url</span> <span class="o">+</span> <span class="s2">&quot;air.mon.1981-2010.ltm.nc&quot;</span><span class="p">,</span> <span class="n">use_cftime</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#  Take global, annual average </span>
<span class="n">coslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ncep_air</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
<span class="n">weight</span> <span class="o">=</span> <span class="n">coslat</span> <span class="o">/</span> <span class="n">coslat</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">Tglobal</span> <span class="o">=</span> <span class="p">(</span><span class="n">ncep_air</span><span class="o">.</span><span class="n">air</span> <span class="o">*</span> <span class="n">weight</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Tglobal</span><span class="p">)</span>

<span class="c1">#  Resuable function to plot the temperature data on a Skew-T chart</span>
<span class="k">def</span> <span class="nf">make_skewT</span><span class="p">():</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
    <span class="n">skew</span> <span class="o">=</span> <span class="n">SkewT</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Tglobal</span><span class="o">.</span><span class="n">level</span><span class="p">,</span> <span class="n">Tglobal</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observations&#39;</span><span class="p">)</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1050</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
    <span class="c1"># Add the relevant special lines</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">plot_dry_adiabats</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">plot_moist_adiabats</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="c1">#skew.plot_mixing_lines()</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (degC)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (hPa)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">skew</span>

<span class="c1">#  and a function to add extra profiles to this chart</span>
<span class="k">def</span> <span class="nf">add_profile</span><span class="p">(</span><span class="n">skew</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Tatm</span> <span class="o">-</span> <span class="n">climlab</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">tempCtoK</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Ts</span> <span class="o">-</span> <span class="n">climlab</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">tempCtoK</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> 
              <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray (level: 17)&gt; Size: 68B
array([ 15.179084  ,  11.207003  ,   7.8383274 ,   0.21994135,
        -6.4483433 , -14.888848  , -25.570469  , -39.36969   ,
       -46.797905  , -53.652245  , -60.56356   , -67.006065  ,
       -65.53293   , -61.48664   , -55.853584  , -51.593952  ,
       -43.21999   ], dtype=float32)
Coordinates:
  * level    (level) float32 68B 1e+03 925.0 850.0 700.0 ... 50.0 30.0 20.0 10.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the water vapor data from CESM output</span>
<span class="c1">#cesm_data_path = &quot;http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/&quot;</span>
<span class="n">cesm_data_path</span> <span class="o">=</span> <span class="s2">&quot;/Users/yuchiaol_ntuas/Desktop/ebooks/data/&quot;</span>
<span class="n">atm_control</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">cesm_data_path</span> <span class="o">+</span> <span class="s2">&quot;cpl_1850_f19.cam.h0.nc&quot;</span><span class="p">)</span>
<span class="c1"># Take global, annual average of the specific humidity</span>
<span class="n">weight_factor</span> <span class="o">=</span> <span class="n">atm_control</span><span class="o">.</span><span class="n">gw</span> <span class="o">/</span> <span class="n">atm_control</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">Qglobal</span> <span class="o">=</span> <span class="p">(</span><span class="n">atm_control</span><span class="o">.</span><span class="n">Q</span> <span class="o">*</span> <span class="n">weight_factor</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>

<span class="c1">#  Make a model on same vertical domain as the GCM</span>
<span class="n">mystate</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">column_state</span><span class="p">(</span><span class="n">lev</span><span class="o">=</span><span class="n">Qglobal</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="n">water_depth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="c1">#  Build the radiation model -- just like we already did</span>
<span class="n">rad</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">RRTMG</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Radiation&#39;</span><span class="p">,</span>
                              <span class="n">state</span><span class="o">=</span><span class="n">mystate</span><span class="p">,</span> 
                              <span class="n">specific_humidity</span><span class="o">=</span><span class="n">Qglobal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                              <span class="n">timestep</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">seconds_per_day</span><span class="p">,</span>
                              <span class="n">albedo</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># surface albedo, tuned to give reasonable ASR for reference cloud-free model</span>
                             <span class="p">)</span>
<span class="c1">#  Now create the convection model</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">convection</span><span class="o">.</span><span class="n">ConvectiveAdjustment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Convection&#39;</span><span class="p">,</span>
                                               <span class="n">state</span><span class="o">=</span><span class="n">mystate</span><span class="p">,</span>
                                               <span class="n">adj_lapse_rate</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span>
                                               <span class="n">timestep</span><span class="o">=</span><span class="n">rad</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
                                              <span class="p">)</span>
<span class="c1">#  Here is where we build the model by coupling together the two components</span>
<span class="n">rcm</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">couple</span><span class="p">([</span><span class="n">rad</span><span class="p">,</span> <span class="n">conv</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Radiative-Convective Model&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rcm</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rcm</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;Radiation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">absorber_vmr</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rcm</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rcm</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climlab Process of type &lt;class &#39;climlab.process.time_dependent_process.TimeDependentProcess&#39;&gt;. 
State variables and domain shapes: 
  Ts: (1,) 
  Tatm: (26,) 
The subprocess tree: 
Radiative-Convective Model: &lt;class &#39;climlab.process.time_dependent_process.TimeDependentProcess&#39;&gt;
   Radiation: &lt;class &#39;climlab.radiation.rrtm.rrtmg.RRTMG&#39;&gt;
      SW: &lt;class &#39;climlab.radiation.rrtm.rrtmg_sw.RRTMG_SW&#39;&gt;
      LW: &lt;class &#39;climlab.radiation.rrtm.rrtmg_lw.RRTMG_LW&#39;&gt;
   Convection: &lt;class &#39;climlab.convection.convadj.ConvectiveAdjustment&#39;&gt;

0.000348
Integrating for 1826 steps, 1826.2110000000002 days, or 5 years.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total elapsed time is 4.999422301147019 years.
None
[-3.3651304e-11]
</pre></div>
</div>
</div>
</div>
<p>Now we make another RCE model with CO2 doubled!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make an exact clone with same temperatures</span>
<span class="n">rcm_2xCO2</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">rcm</span><span class="p">)</span>
<span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Radiative-Convective Model (2xCO2 initial)&#39;</span>

<span class="c1">#  Check to see that we indeed have the same CO2 amount</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;Radiation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">absorber_vmr</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">])</span>

<span class="c1">#  Now double it!</span>
<span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;Radiation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">absorber_vmr</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;Radiation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">absorber_vmr</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.000348
0.000696
</pre></div>
</div>
</div>
</div>
<p>Let’s quickly check the instantaneous radiative forcing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">compute_diagnostics</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">ASR</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">OLR</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span>

<span class="n">DeltaR_instant</span> <span class="o">=</span> <span class="p">(</span><span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm_2xCO2</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">rcm</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">DeltaR_instant</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.06274162]
[-2.11458541]
[2.17732704]
</pre></div>
</div>
</div>
</div>
<p>What is the instantaneous radiative forcing in our two/three-layer model?</p>
<p>Now we briefly calculate the adjusted radiative forcing. Recall that the adjusted radiative forcing is that the stratosphere is adjusted while the troposphere does not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print out troposphere</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rcm</span><span class="o">.</span><span class="n">lev</span><span class="p">[</span><span class="mi">13</span><span class="p">:])</span>

<span class="n">rcm_2xCO2_strat</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">rcm_2xCO2</span><span class="p">)</span>
<span class="n">rcm_2xCO2_strat</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Radiative-Convective Model (2xCO2 stratosphere-adjusted)&#39;</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">rcm_2xCO2_strat</span><span class="o">.</span><span class="n">step_forward</span><span class="p">()</span>
<span class="c1"># hold tropospheric and surface temperatures fixed</span>
    <span class="n">rcm_2xCO2_strat</span><span class="o">.</span><span class="n">Tatm</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span> <span class="o">=</span> <span class="n">rcm</span><span class="o">.</span><span class="n">Tatm</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span>
    <span class="n">rcm_2xCO2_strat</span><span class="o">.</span><span class="n">Ts</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">rcm</span><span class="o">.</span><span class="n">Ts</span><span class="p">[:]</span>

<span class="n">DeltaR</span> <span class="o">=</span> <span class="p">(</span><span class="n">rcm_2xCO2_strat</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm_2xCO2_strat</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">rcm</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DeltaR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[226.513265 266.481155 313.501265 368.81798  433.895225 510.455255
 600.5242   696.79629  787.70206  867.16076  929.648875 970.55483
 992.5561  ]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4.28837377]
</pre></div>
</div>
</div>
</div>
<p>Radiative forcing gives us some insights about how the changes of forcing could tranfer energy to the system, and temperature might change. But not the final temperature reaching equilibrium.</p>
<p><a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2019RG000678">Sherwood et al. (2020)</a> summarize the radiative forcing:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/sherwood_erf.jpg"><img alt="../_images/sherwood_erf.jpg" src="../_images/sherwood_erf.jpg" style="width: 554.4px; height: 507.0px;" /></a>
</figure>
</section>
<section id="equilibrium-climate-sensitivity-ecs-without-feedback">
<h2>Equilibrium climate sensitivity (ECS) without feedback<a class="headerlink" href="#equilibrium-climate-sensitivity-ecs-without-feedback" title="Permalink to this heading">#</a></h2>
<p>We define the ECS as “The global mean surface warming necessary to balance the planetary energy budget after a doubling of atmospheric CO2”.</p>
<p>If we assume incoming shortwave radiation does not change (e.g., the planetary albedo does not change) after doubling CO2, the climate system has to adjust to new equilibrium temperature. This new temperature must balance the radiative forcing. So, we can get:</p>
<div class="math notranslate nohighlight" id="equation-my-label62">
<span class="eqno">(62)<a class="headerlink" href="#equation-my-label62" title="Permalink to this equation">#</a></span>\[\Delta R = OLR_{f} - OLR_{2xCO2},\]</div>
<p>where <span class="math notranslate nohighlight">\(OLR_{f}\)</span> is the equilibrated <span class="math notranslate nohighlight">\(OLR\)</span> associated with the new qeuilibrium temperature.</p>
<p>We know that from our zero-dimensional energy-balance model, we derive the OLR sensitivity to temperature change:</p>
<div class="math notranslate nohighlight" id="equation-my-label63">
<span class="eqno">(63)<a class="headerlink" href="#equation-my-label63" title="Permalink to this equation">#</a></span>\[\lambda_{0} = 4\tau\sigma T_{eq}^{3} \approx 3.3 \mbox{ W/m$^2$/K}\]</div>
<p>So we can write:</p>
<div class="math notranslate nohighlight" id="equation-my-label64">
<span class="eqno">(64)<a class="headerlink" href="#equation-my-label64" title="Permalink to this equation">#</a></span>\[OLR_{f} \approx OLR_{2xCO2} + \lambda_{0}\Delta T_{0},\]</div>
<p>The energy balance gives us:</p>
<div class="math notranslate nohighlight" id="equation-my-label65">
<span class="eqno">(65)<a class="headerlink" href="#equation-my-label65" title="Permalink to this equation">#</a></span>\[\Delta R = OLR_{f} - OLR_{2xCO2} \approx OLR_{2xCO2} + \lambda_{0}\Delta T_{0} - OLR_{2xCO2} = \lambda_{0}\Delta T_{0}\]</div>
<div class="math notranslate nohighlight" id="equation-my-label66">
<span class="eqno">(66)<a class="headerlink" href="#equation-my-label66" title="Permalink to this equation">#</a></span>\[\rightarrow \Delta T_{0} = \frac{\Delta R}{\lambda_{0}}\]</div>
<p>Assume the actual radiative forcing after doubling CO2 is about 4 W/m<span class="math notranslate nohighlight">\(^2\)</span>/K, we can get:</p>
<div class="math notranslate nohighlight" id="equation-my-label67">
<span class="eqno">(67)<a class="headerlink" href="#equation-my-label67" title="Permalink to this equation">#</a></span>\[\Delta T_{0} = \frac{\Delta R}{\lambda_{0}} = \frac{4}{3.3} \approx 1.2 \mbox{ K}\]</div>
<p>This is the ECS without feedback using zero-dimensional model!!!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">OLRobserved</span> <span class="o">=</span> <span class="mf">238.5</span>  <span class="c1"># in W/m2</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">5.67E-8</span>  <span class="c1"># S-B constant</span>
<span class="n">Tsobserved</span> <span class="o">=</span> <span class="mf">288.</span>  <span class="c1"># global average surface temperature</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">OLRobserved</span> <span class="o">/</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">Tsobserved</span><span class="o">**</span><span class="mi">4</span>  <span class="c1"># solve for tuned value of transmissivity</span>

<span class="n">lambda_0</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">Tsobserved</span><span class="o">**</span><span class="mi">3</span>

<span class="n">DeltaR_test</span> <span class="o">=</span> <span class="mf">4.</span>  <span class="c1"># Radiative forcing in W/m2</span>
<span class="n">DeltaT0</span> <span class="o">=</span> <span class="n">DeltaR_test</span> <span class="o">/</span> <span class="n">lambda_0</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;The Equilibrium Climate Sensitivity in the absence of feedback is </span><span class="si">{:.1f}</span><span class="s1"> K.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DeltaT0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Equilibrium Climate Sensitivity in the absence of feedback is 1.2 K.
</pre></div>
</div>
</div>
</div>
<p>Now we use RCE models to estimate ECS.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rcm_2xCO2_eq</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">rcm_2xCO2_strat</span><span class="p">)</span>
<span class="n">rcm_2xCO2_eq</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Radiative-Convective Model (2xCO2 equilibrium)&#39;</span>
<span class="n">rcm_2xCO2_eq</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rcm_2xCO2_eq.ASR - rcm_2xCO2_eq.OLR&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rcm_2xCO2_eq</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm_2xCO2_eq</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span>

<span class="n">skew</span> <span class="o">=</span> <span class="n">make_skewT</span><span class="p">()</span>
<span class="n">add_profile</span><span class="p">(</span><span class="n">skew</span><span class="p">,</span> <span class="n">rcm_2xCO2_strat</span><span class="p">)</span>
<span class="n">add_profile</span><span class="p">(</span><span class="n">skew</span><span class="p">,</span> <span class="n">rcm_2xCO2_eq</span><span class="p">)</span>
<span class="n">add_profile</span><span class="p">(</span><span class="n">skew</span><span class="p">,</span> <span class="n">rcm</span><span class="p">)</span>

<span class="n">ECS_nofeedback</span> <span class="o">=</span> <span class="n">rcm_2xCO2_eq</span><span class="o">.</span><span class="n">Ts</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">Ts</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ECS with no feedback&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ECS_nofeedback</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rcm_2xCO2_eq.OLR - rcm.OLR&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rcm_2xCO2_eq</span><span class="o">.</span><span class="n">OLR</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rcm_2xCO2_eq.ASR - rcm.ASR&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rcm_2xCO2_eq</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">ASR</span><span class="p">)</span>

<span class="n">lambda0</span> <span class="o">=</span> <span class="n">DeltaR</span> <span class="o">/</span> <span class="n">ECS_nofeedback</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lambda0&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lambda0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integrating for 1826 steps, 1826.2110000000002 days, or 5 years.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total elapsed time is 12.736753858124827 years.
rcm_2xCO2_eq.ASR - rcm_2xCO2_eq.OLR
[1.31308298e-11]
ECS with no feedback
[1.29984831]
rcm_2xCO2_eq.OLR - rcm.OLR
[0.05080282]
rcm_2xCO2_eq.ASR - rcm.ASR
[0.05080282]
lambda0
[3.29913401]
</pre></div>
</div>
<img alt="../_images/f79f0037516e3c650de86b57a0361cf51633228959aef76d3eee986e581162fc.png" src="../_images/f79f0037516e3c650de86b57a0361cf51633228959aef76d3eee986e581162fc.png" />
</div>
</div>
</section>
<section id="climate-feedback">
<h2>Climate feedback<a class="headerlink" href="#climate-feedback" title="Permalink to this heading">#</a></h2>
<p>I guess that the feedback concept is inherited from electronic engineering.
For example, Professor Gu-Yeon Wei’s lecture 18 introduced the feedback concept <a class="reference external" href="https://in.ncu.edu.tw/~ncume_ee/harvard-es154/lect_18_feedback.pdf">(here)</a>:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/feedback0.png"><img alt="../_images/feedback0.png" src="../_images/feedback0.png" style="width: 522.0px; height: 195.0px;" /></a>
</figure>
<p>In climate science, we can think of “Source” as forcing or input added to the system, A as the whole process in the system, <span class="math notranslate nohighlight">\(\beta\)</span> (gain) as the amplifier or deamplifier, and the load is the output.</p>
<p>We use <span class="math notranslate nohighlight">\(f\)</span> to quantify the effect and strength of <span class="math notranslate nohighlight">\(\beta\)</span> (gain). If it is positive (<span class="math notranslate nohighlight">\(f&gt;0\)</span>), we call it amplifying feedback. If it is negative (<span class="math notranslate nohighlight">\(f&lt;0\)</span>), we call it dampling feedback.</p>
<p>Can you give examples for positive and negative feedbacks in the atmosphere or climate system?</p>
<p>In Arctic climate system, the feedbacks could be complex. In <a class="reference external" href="https://www.nature.com/articles/s41467-018-04173-0">Goosse et al. (2018)</a>, they summarized some feedbacks in the Arctic:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/arctic_feedback.png"><img alt="../_images/arctic_feedback.png" src="../_images/arctic_feedback.png" style="width: 600.3px; height: 436.5px;" /></a>
</figure>
<p>Let’s work on how to quantify the effect of feedbacks. We strat with the temperature change considered in a system without feedback:</p>
<div class="math notranslate nohighlight" id="equation-my-label68">
<span class="eqno">(68)<a class="headerlink" href="#equation-my-label68" title="Permalink to this equation">#</a></span>\[\Delta T_{0} = \frac{\Delta R}{\lambda_{0}}\]</div>
<p>We assume that a positive feedback (e.g., water vapor feedback) is included and taking action. So its effect is to “enhance” the temperature change positively with a fraction of <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-my-label69">
<span class="eqno">(69)<a class="headerlink" href="#equation-my-label69" title="Permalink to this equation">#</a></span>\[f\lambda_{0}\Delta T_{0}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="math notranslate nohighlight" id="equation-my-label70">
<span class="eqno">(70)<a class="headerlink" href="#equation-my-label70" title="Permalink to this equation">#</a></span>\[\mbox{why  } -\infty &lt; f \le 1 \mbox{ ???}\]</div>
</div>
<p>With infinity loops, we take the sum of each feedback effect:</p>
<div class="math notranslate nohighlight" id="equation-my-label71">
<span class="eqno">(71)<a class="headerlink" href="#equation-my-label71" title="Permalink to this equation">#</a></span>\[f\lambda_{0}\Delta T_{0} + f^{2}\lambda_{0}\Delta T_{0} + \cdots = (f+f^{2}+\cdots)\lambda_{0}\Delta T_{0} = \lambda_{0}\Delta T_{0}\sum_{n=1}^{\infty}f^{n}\]</div>
<p>Sum the original response to forcing <span class="math notranslate nohighlight">\(\Delta R = \lambda_{0}\Delta T_{0}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-my-label72">
<span class="eqno">(72)<a class="headerlink" href="#equation-my-label72" title="Permalink to this equation">#</a></span>\[\lambda_{0}\Delta T_{0} + \lambda_{0}\Delta T_{0}\sum_{n=1}^{\infty}f^{n} = \lambda_{0}\Delta T_{0}\sum_{n=0}^{\infty}f^{n} = \frac{1}{1-f}\lambda_{0}\Delta T_{0}\]</div>
<p>So the final response is</p>
<div class="math notranslate nohighlight" id="equation-my-label73">
<span class="eqno">(73)<a class="headerlink" href="#equation-my-label73" title="Permalink to this equation">#</a></span>\[\lambda_{0}\Delta T = \frac{1}{1-f}\lambda_{0}\Delta T_{0}\]</div>
<div class="math notranslate nohighlight" id="equation-my-label74">
<span class="eqno">(74)<a class="headerlink" href="#equation-my-label74" title="Permalink to this equation">#</a></span>\[\rightarrow \Delta T = \frac{1}{1-f}\Delta T_{0}\]</div>
<p>We define the gain as:</p>
<div class="math notranslate nohighlight" id="equation-my-label75">
<span class="eqno">(75)<a class="headerlink" href="#equation-my-label75" title="Permalink to this equation">#</a></span>\[g = \frac{1}{1-f} = \frac{\Delta T}{\Delta T_{0}}\]</div>
<p>What does this mean? How about a negative feedback?</p>
<p>If the system has N individual feedbacks, the total effect can be summed:</p>
<div class="math notranslate nohighlight" id="equation-my-label76">
<span class="eqno">(76)<a class="headerlink" href="#equation-my-label76" title="Permalink to this equation">#</a></span>\[f = f_{1} + f_{2} + \cdots f_{N} = \sum_{i=1}^{N}f_{i}\]</div>
<p>The ECS now becomes:</p>
<div class="math notranslate nohighlight" id="equation-my-label77">
<span class="eqno">(77)<a class="headerlink" href="#equation-my-label77" title="Permalink to this equation">#</a></span>\[\Delta T_{2xCO2} = \frac{1}{1-\sum_{i=1}^{N}f_{i}}\Delta T_{0} = \frac{1}{1-\sum_{i=1}^{N}f_{i}}\frac{\Delta R}{\lambda_{0}}\]</div>
<p>We can define feedback parameter in the unit of W/m<span class="math notranslate nohighlight">\(^2\)</span>/K as:</p>
<div class="math notranslate nohighlight" id="equation-my-label78">
<span class="eqno">(78)<a class="headerlink" href="#equation-my-label78" title="Permalink to this equation">#</a></span>\[\lambda_{i} = f_{i}\lambda_{0}\]</div>
<p>Then:</p>
<div class="math notranslate nohighlight" id="equation-my-label79">
<span class="eqno">(79)<a class="headerlink" href="#equation-my-label79" title="Permalink to this equation">#</a></span>\[\Delta T_{2xCO2} = \frac{\Delta R}{\lambda_{0}-\sum_{i=1}^{N}\lambda_{i}}\]</div>
<p>So the total feedback (parameter) could be decompose into:</p>
<div class="math notranslate nohighlight" id="equation-my-label80">
<span class="eqno">(80)<a class="headerlink" href="#equation-my-label80" title="Permalink to this equation">#</a></span>\[\lambda = \lambda_{0} - \sum_{i=1}^{N}\lambda_{i}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="math notranslate nohighlight">\(\lambda_{0}=3.3\)</span> W/m<span class="math notranslate nohighlight">\(^2\)</span>/K is the Planck feedback parameter. This is not a real feedback (right?), and simply as a consequence of a warmer world emits more longwave radiation than a colder world.</p>
</div>
<p>This formulation is very useful, becasue we can qunatitatively compare the importance of each feedback. Below is an example from my paper:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/my_feedback0.png"><img alt="../_images/my_feedback0.png" src="../_images/my_feedback0.png" style="width: 418.59999999999997px; height: 296.79999999999995px;" /></a>
</figure>
<p>Now let’s add a water vapor feedback into our RCE model and calculate ECS and feedback parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  actual specific humidity</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">rcm</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;Radiation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">specific_humidity</span>
<span class="c1">#  saturation specific humidity (a function of temperature and pressure)</span>
<span class="n">qsat</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">thermo</span><span class="o">.</span><span class="n">qsat</span><span class="p">(</span><span class="n">rcm</span><span class="o">.</span><span class="n">Tatm</span><span class="p">,</span> <span class="n">rcm</span><span class="o">.</span><span class="n">lev</span><span class="p">)</span>
<span class="c1">#  Relative humidity</span>
<span class="n">rh</span> <span class="o">=</span> <span class="n">q</span><span class="o">/</span><span class="n">qsat</span>

<span class="c1">#  Plot relative humidity in percent</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">rcm</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (hPa)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Specific humidity (g/kg)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rh</span><span class="o">*</span><span class="mf">100.</span><span class="p">,</span> <span class="n">rcm</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Relative humidity (%)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/044bfe8bbe4196079b5a70bd33d23e90acd64a079ad5824672ad3f6e192eafe4.png" src="../_images/044bfe8bbe4196079b5a70bd33d23e90acd64a079ad5824672ad3f6e192eafe4.png" />
</div>
</div>
<p>We consider the relative humidity somewhat fixed, while saturation specific humidity varied with temperature changes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rcm_2xCO2_h2o</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">rcm_2xCO2</span><span class="p">)</span>
<span class="n">rcm_2xCO2_h2o</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RCE Model (2xCO2 equilibrium with H2O feedback)&#39;</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
    <span class="c1"># At every timestep</span>
    <span class="c1"># we calculate the new saturation specific humidity for the new temperature</span>
    <span class="c1">#  and change the water vapor in the radiation model</span>
    <span class="c1">#  so that relative humidity is always the same</span>
    <span class="n">qsat</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">thermo</span><span class="o">.</span><span class="n">qsat</span><span class="p">(</span><span class="n">rcm_2xCO2_h2o</span><span class="o">.</span><span class="n">Tatm</span><span class="p">,</span> <span class="n">rcm_2xCO2_h2o</span><span class="o">.</span><span class="n">lev</span><span class="p">)</span>
    <span class="n">rcm_2xCO2_h2o</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;Radiation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">specific_humidity</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">rh</span> <span class="o">*</span> <span class="n">qsat</span>
    <span class="n">rcm_2xCO2_h2o</span><span class="o">.</span><span class="n">step_forward</span><span class="p">()</span>

<span class="c1"># Check for energy balance</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rcm_2xCO2_h2o</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">rcm_2xCO2_h2o</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span>

<span class="n">skew</span> <span class="o">=</span> <span class="n">make_skewT</span><span class="p">()</span>
<span class="n">add_profile</span><span class="p">(</span><span class="n">skew</span><span class="p">,</span> <span class="n">rcm</span><span class="p">)</span>
<span class="n">add_profile</span><span class="p">(</span><span class="n">skew</span><span class="p">,</span> <span class="n">rcm_2xCO2_strat</span><span class="p">)</span>
<span class="n">add_profile</span><span class="p">(</span><span class="n">skew</span><span class="p">,</span> <span class="n">rcm_2xCO2_eq</span><span class="p">)</span>
<span class="n">add_profile</span><span class="p">(</span><span class="n">skew</span><span class="p">,</span> <span class="n">rcm_2xCO2_h2o</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.73180638e-07]
</pre></div>
</div>
<img alt="../_images/eeacdc5ba4aa62524c3741a8a290fa810acd6dfad06ec92684a5ee219f898a88.png" src="../_images/eeacdc5ba4aa62524c3741a8a290fa810acd6dfad06ec92684a5ee219f898a88.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ECS</span> <span class="o">=</span> <span class="n">rcm_2xCO2_h2o</span><span class="o">.</span><span class="n">Ts</span> <span class="o">-</span> <span class="n">rcm</span><span class="o">.</span><span class="n">Ts</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ECS&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ECS</span><span class="p">)</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">ECS</span> <span class="o">/</span> <span class="n">ECS_nofeedback</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gain&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="n">lambda_net</span> <span class="o">=</span> <span class="n">DeltaR</span> <span class="o">/</span> <span class="n">ECS</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lambda_net&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lambda_net</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lambda0&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lambda0</span><span class="p">)</span>

<span class="n">lambda_h2o</span> <span class="o">=</span> <span class="n">lambda0</span> <span class="o">-</span> <span class="n">lambda_net</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lambda_h2o&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lambda_h2o</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ECS
[2.98902357]
gain
[2.29951722]
lambda_net
[1.43470724]
lambda0
[3.29913401]
lambda_h2o
[1.86442677]
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight" id="equation-my-label81">
<span class="eqno">(81)<a class="headerlink" href="#equation-my-label81" title="Permalink to this equation">#</a></span>\[\lambda_{H2O} = \lambda_{0} - \lambda = 3.3 - 1.43 \approx 1.87\]</div>
<p>“For every 1 degree of surface warming, the increased water vapor greenhouse effect provides an additional 1.86 W m<span class="math notranslate nohighlight">\(^{-2}\)</span> of radiative forcing.”</p>
<p><a class="reference external" href="https://www.ipcc.ch/report/ar5/wg1/">Flato et al. (2013)</a> in IPCC AR5 reported the climate feedbacks:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/flato_feedbacks.png"><img alt="../_images/flato_feedbacks.png" src="../_images/flato_feedbacks.png" style="width: 808.0px; height: 445.0px;" /></a>
</figure>
<p><a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2019RG000678">Sherwood et al. (2020)</a> summarize the climate feedbacks:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/sherwood_feedbacks.jpg"><img alt="../_images/sherwood_feedbacks.jpg" src="../_images/sherwood_feedbacks.jpg" style="width: 762.0px; height: 417.20000000000005px;" /></a>
</figure>
<p><a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2019GL085782">Zelinka et a. (2020)</a> highlighted the uncertainty of ECS comes from the uncertainty of cloud feedback:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/cloud_feedback_ecs_tmp1.jpg"><img alt="../_images/cloud_feedback_ecs_tmp1.jpg" src="../_images/cloud_feedback_ecs_tmp1.jpg" style="width: 851.2px; height: 551.2px;" /></a>
</figure>
</section>
<section id="the-physical-model-putting-together">
<h2>The physical model - putting together<a class="headerlink" href="#the-physical-model-putting-together" title="Permalink to this heading">#</a></h2>
<p>We review Section 2.2 of <a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2019RG000678">Sherwood et al. (2020)</a> to put everything together. This is the conventional model for feedback-forcing theory.</p>
<div class="math notranslate nohighlight" id="equation-my-label82">
<span class="eqno">(82)<a class="headerlink" href="#equation-my-label82" title="Permalink to this equation">#</a></span>\[\Delta N = \Delta F + \Delta R + V,\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta N\)</span> is the net downward radiation imbalance at TOA, <span class="math notranslate nohighlight">\(\Delta F\)</span> is the radiative forcing, and <span class="math notranslate nohighlight">\(\Delta R\)</span> is the radiative response due to direct or indirect changes in temperature, and <span class="math notranslate nohighlight">\(V\)</span> is the unrelated processes.</p>
<p>Assume that the radiative response <span class="math notranslate nohighlight">\(\Delta R\)</span> is proportional to first order of the forced change in global mean surface air temperature (<span class="math notranslate nohighlight">\(\Delta T_s\)</span>, using Taylor expansion), we can get:</p>
<div class="math notranslate nohighlight" id="equation-my-label83">
<span class="eqno">(83)<a class="headerlink" href="#equation-my-label83" title="Permalink to this equation">#</a></span>\[\Delta N = \Delta F + \lambda\Delta T_{s} + V.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What is the sign of <span class="math notranslate nohighlight">\(\lambda\)</span>? Can the system reach to an equilibrium state if <span class="math notranslate nohighlight">\(\lambda\)</span> is positive?</p>
</div>
<p>Consider the climate system reaches an equilibrium state over a sufficient long time, so we can neglect <span class="math notranslate nohighlight">\(\Delta N\)</span> and <span class="math notranslate nohighlight">\(V\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-my-label84">
<span class="eqno">(84)<a class="headerlink" href="#equation-my-label84" title="Permalink to this equation">#</a></span>\[\Delta T_{s} = -\frac{\Delta F}{\lambda}.\]</div>
<p>So the climate sensitivity of doubling CO2 can be expressed as below:</p>
<div class="math notranslate nohighlight" id="equation-my-label85">
<span class="eqno">(85)<a class="headerlink" href="#equation-my-label85" title="Permalink to this equation">#</a></span>\[S_{2xCO2} = -\frac{\Delta F_{2xCO2}}{\lambda}\]</div>
<p>The feedback <span class="math notranslate nohighlight">\(\lambda\)</span> can be decomposed into each feedback process:</p>
<div class="math notranslate nohighlight" id="equation-my-label86">
<span class="eqno">(86)<a class="headerlink" href="#equation-my-label86" title="Permalink to this equation">#</a></span>\[\lambda = \sum_{i}^{6?} {\lambda_{i}}\]</div>
<ul class="simple">
<li><p>Feebacks can change strength in different climate state –&gt; state dependence <span class="math notranslate nohighlight">\(\Delta \lambda_{state}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta N\)</span> can not only depend on global-mean surface air temperature but also the geographic distribution or pattern –&gt; pattern effect <span class="math notranslate nohighlight">\(\Delta \lambda_{pattern}\)</span></p></li>
</ul>
<p>We can modify the model as:</p>
<div class="math notranslate nohighlight" id="equation-my-label87">
<span class="eqno">(87)<a class="headerlink" href="#equation-my-label87" title="Permalink to this equation">#</a></span>\[\Delta N = \Delta F + (\lambda - \Delta \lambda)\Delta T_{s},\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-my-label88">
<span class="eqno">(88)<a class="headerlink" href="#equation-my-label88" title="Permalink to this equation">#</a></span>\[\Delta \lambda = \Delta \lambda_{state} + \Delta \lambda_{pattern} = \frac{\partial \lambda}{\partial T_{s}}\Delta T_{s} + \frac{\partial \lambda}{\partial T_{s}^{'}(x)}\Delta T_{s}^{'}(x)\]</div>
<p>How to calculate <span class="math notranslate nohighlight">\(\Delta \lambda_{state}\)</span> and <span class="math notranslate nohighlight">\(\Delta \lambda_{pattern}\)</span> is another long story.</p>
</section>
<section id="radiative-kernel-analysis">
<h2>Radiative kernel analysis<a class="headerlink" href="#radiative-kernel-analysis" title="Permalink to this heading">#</a></h2>
<p>The feedback may/should have spatial structure, right? For example, sea-ice albedo feedback should be strongest in polar regions, but very week or no effect in the tropics, right?</p>
<p>To the end of complex climate model similations, climate scientists have developed a method to compute the feedback with spatial structure.
This is called the radiative kernel method.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/radiative_kernel_tmp4.jpg"><img alt="../_images/radiative_kernel_tmp4.jpg" src="../_images/radiative_kernel_tmp4.jpg" style="width: 552.5px; height: 357.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 34 </span><span class="caption-text">Multimodel ensemble-mean maps of the temperature, water vapor, albedo, and cloud feedback computed using climate response patterns from the IPCC AR4 models and the GFDL radiative kernels. Source: <a class="reference external" href="https://journals.ametsoc.org/view/journals/clim/21/14/2007jcli2110.1.xml">Soden et al. (2008)</a></span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We use CESM1-CAM5 kernel for demonstration: see <a class="reference external" href="https://essd.copernicus.org/articles/10/317/2018/">Pendergrass et al. (2018)</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CESM1-CAM5 kernel can be found on Professor Angeline G. Pendergrass’ <a class="reference external" href="https://github.com/apendergrass/cam5-kernels">GitHub</a></p>
</div>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../_images/radiative_kernel_tmp1.png"><img alt="../_images/radiative_kernel_tmp1.png" src="../_images/radiative_kernel_tmp1.png" style="width: 687.4px; height: 862.05px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 35 </span><span class="caption-text">Top-of-atmosphere kernels from CESM1(CAM5). Zonal, annual-mean temperature, longwave moisture, and shortwave moisture kernels for all-sky and clear-sky. In panels (e) and (g) all-sky kernels are shown in solid lines and clear-sky kernels in dashed lines. The sign convention is positive downward. Source: <a class="reference external" href="https://essd.copernicus.org/articles/10/317/2018/">Pendergrass et al. (2018)</a>.</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="../_images/radiative_kernel_tmp2.png"><img alt="../_images/radiative_kernel_tmp2.png" src="../_images/radiative_kernel_tmp2.png" style="width: 584.1px; height: 320.1px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 36 </span><span class="caption-text">CESM large-ensemble kernels. Feedback calculation for the CESM 40-member large ensemble using the TOA kernels. Source: <a class="reference external" href="https://essd.copernicus.org/articles/10/317/2018/">Pendergrass et al. (2018)</a>.</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="../_images/radiative_kernel_tmp3.png"><img alt="../_images/radiative_kernel_tmp3.png" src="../_images/radiative_kernel_tmp3.png" style="width: 723.0999999999999px; height: 292.59999999999997px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 37 </span><span class="caption-text">Comparison of TOA radiative feedbacks. TOA radiative feedbacks (Wm<span class="math notranslate nohighlight">\(^{-2}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span>) averaged over 40 CESM large-ensemble simulations diagnosed with CAM5 radiative kernels, compared against those from CMIP3 model simulations diagnosed with three different kernels as reported by <a class="reference external" href="https://journals.ametsoc.org/view/journals/clim/21/14/2007jcli2110.1.xml">Soden et al. (2008)</a>, and MPI-ESM-LR control state kernels and years 21–150 of abrupt carbon dioxide quadrupling simulations from the same model (Block and Mauritsen, 2013). Table from <a class="reference external" href="https://essd.copernicus.org/articles/10/317/2018/">Pendergrass et al. (2018)</a>.</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="homework-assignment-x-due-xxx">
<h2>Homework assignment X (due xxx)<a class="headerlink" href="#homework-assignment-x-due-xxx" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Please change adj_lapse_rate = 9.8. This is the dry adiabatic lapse rate. Calculate the water feedback parameter in this scenario.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="rce_model.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">11. Radiative Convective Equilibrium (RCE)</p>
      </div>
    </a>
    <a class="right-next"
       href="rae_model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">13. Radiative Advective Equilibrium (RAE)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#radiative-forcing">Radiative forcing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-climate-sensitivity-ecs-without-feedback">Equilibrium climate sensitivity (ECS) without feedback</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#climate-feedback">Climate feedback</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-physical-model-putting-together">The physical model - putting together</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#radiative-kernel-analysis">Radiative kernel analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homework-assignment-x-due-xxx">Homework assignment X (due xxx)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yu-Chiao Liang
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>