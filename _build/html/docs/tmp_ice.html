

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Ice Albedo Feedback in EBM &#8212; Polar Climate Change Home</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/tmp_ice';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/front_page_image.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/front_page_image.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview_arctic.html">Overview of Arctic and Antarctic</a></li>
<li class="toctree-l1"><a class="reference internal" href="snow.html">Snow</a></li>
<li class="toctree-l1"><a class="reference internal" href="permafrost.html">Permafrost</a></li>
<li class="toctree-l1"><a class="reference internal" href="glaciers.html">Glaciers</a></li>
<li class="toctree-l1"><a class="reference internal" href="sea_ice.html">Sea ice</a></li>
<li class="toctree-l1"><a class="reference internal" href="pv_ssw.html">Polar Stratospheric Circulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cause_aa.html">Causes of Polar Amplification</a></li>
<li class="toctree-l1"><a class="reference internal" href="zero_dim_model.html">Zero-dimensional Energy Balance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="layer_model.html">Layered Energy Balance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="rce_model.html">Radiative Convective Equilibrium (RCE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="climate_sensitivity.html">Climate Sensitivity and Feedback</a></li>
<li class="toctree-l1"><a class="reference internal" href="rae_model.html">Radiative Advective Equilibrium (RAE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="one_dim_ebm.html">One-dimensional Energy Balance Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="seasonality.html">Seasonal cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="ice_albedo_ebm.html">Ice Albedo Feedback in EBM</a></li>
<li class="toctree-l1"><a class="reference internal" href="effect_aa.html">Arctic-Midlatitude Linkage</a></li>
<li class="toctree-l1"><a class="reference internal" href="history_modelling.html">The History of Climate Modeling</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/tmp_ice.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ice Albedo Feedback in EBM</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-ice-snow-line-step-function">Interactive ice/snow line (step function)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polar-amplified-warming-in-ebm-yeah">Polar-amplified warming in EBM (Yeah!!!)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solar-forcing">Solar forcing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-effect-of-diffusivity-with-albedo-feedback">The effect of diffusivity with albedo feedback</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusive-response-to-a-point-source-of-energy-at-45-on">Diffusive response to a point source of energy at 45<span class="math notranslate nohighlight">\(^o\)</span>N</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ice-cap-instability">Ice cap instability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-snowball-earth-hypothesis">The snowball Earth hypothesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hysteresis-in-ebm">Hysteresis in EBM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homework-assignment-x-due-xxx">Homework assignment X (due xxx)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ice-albedo-feedback-in-ebm">
<span id="ice-albedo-ebm"></span><h1>Ice Albedo Feedback in EBM<a class="headerlink" href="#ice-albedo-feedback-in-ebm" title="Permalink to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Python scripts used below and some materials are modified from Prof. Brian E. J. Rose’s climlab <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook/courseware/seasonal-cycle.html">website</a>.</p>
</div>
<section id="interactive-ice-snow-line-step-function">
<h2>Interactive ice/snow line (step function)<a class="headerlink" href="#interactive-ice-snow-line-step-function" title="Permalink to this heading">#</a></h2>
<p>The idea is to change the albedo as a function of latitude and a threshold temperatre <span class="math notranslate nohighlight">\(T_{f} = -10 ^{o}C\)</span>. This is historically inheritated from Budyko’s model.</p>
<div class="math notranslate nohighlight" id="equation-my-label171">
<span class="eqno">()<a class="headerlink" href="#equation-my-label171" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{eqnarray}
\alpha(\phi,T(\phi)) &amp;=&amp; \alpha_{0} + \alpha_{2}P_{2}(\sin(\phi)), &amp;\mbox{  when }&amp; T(\phi) &gt; T_{f}\\
&amp;=&amp; \alpha_{i}, &amp;\mbox{  when }&amp; T(\phi) \le T_{f}
\end{eqnarray}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{2}(sin(\phi))=\frac{1}{2}(3\sin(\phi)^{2}-1)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">climlab</span>
<span class="kn">from</span> <span class="nn">climlab</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>

<span class="c1">#  for convenience, set up a dictionary with our reference parameters</span>
<span class="n">param</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D&#39;</span><span class="p">:</span><span class="mf">0.55</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">210</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">:</span><span class="mf">0.078</span><span class="p">,</span> <span class="s1">&#39;ai&#39;</span><span class="p">:</span><span class="mf">0.62</span><span class="p">,</span> <span class="s1">&#39;Tf&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">10.</span><span class="p">}</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;EBM with interactive ice line&#39;</span><span class="p">,</span>
                            <span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> 
                            <span class="n">D</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span> 
                            <span class="n">A</span><span class="o">=</span><span class="mf">210.</span><span class="p">,</span> 
                            <span class="n">B</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> 
                            <span class="n">Tf</span><span class="o">=-</span><span class="mf">10.</span><span class="p">,</span> 
                            <span class="n">a0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                            <span class="n">a2</span><span class="o">=</span><span class="mf">0.078</span><span class="p">,</span> 
                            <span class="n">ai</span><span class="o">=</span><span class="mf">0.62</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>

<span class="c1">#  A python shortcut... we can use the dictionary to pass lots of input arguments simultaneously:</span>

<span class="c1">#  same thing as before, but written differently:</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;EBM with interactive ice line&#39;</span><span class="p">,</span>
                            <span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">param</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ebm_plot</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">return_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>    
    <span class="n">templimits</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="mi">32</span>
    <span class="n">radlimits</span> <span class="o">=</span> <span class="o">-</span><span class="mi">340</span><span class="p">,</span> <span class="mi">340</span>
    <span class="n">htlimits</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
    <span class="n">latlimits</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span>
    <span class="n">lat_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">templimits</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">ASR</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SW&#39;</span> <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="o">-</span><span class="n">e</span><span class="o">.</span><span class="n">OLR</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LW&#39;</span> <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">,</span> <span class="s1">&#39;c-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;net rad&#39;</span> <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">heat_transport_convergence</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dyn&#39;</span> <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">net_radiation</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">heat_transport_convergence</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;total&#39;</span> <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">radlimits</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy budget (W m$^{-2}$)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">lat_bounds</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">heat_transport</span> <span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">htlimits</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Heat transport (PW)&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">latlimits</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">lat_ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">return_fig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span>

<span class="n">model1</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">model1</span><span class="o">.</span><span class="n">ASR</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>

<span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">model1</span><span class="o">.</span><span class="n">OLR</span><span class="p">)</span>

<span class="c1"># Integrate out to equilibrium.</span>
<span class="n">model1</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="c1">#  Check for energy balance</span>
<span class="nb">print</span><span class="p">(</span><span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ebm_plot</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span>

<span class="c1">#  There is a diagnostic that tells us the current location of the ice edge:</span>
<span class="n">model1</span><span class="o">.</span><span class="n">icelat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climlab Process of type &lt;class &#39;climlab.model.ebm.EBM_annual&#39;&gt;. 
State variables and domain shapes: 
  Ts: (180, 1) 
The subprocess tree: 
EBM with interactive ice line: &lt;class &#39;climlab.model.ebm.EBM_annual&#39;&gt;
   LW: &lt;class &#39;climlab.radiation.aplusbt.AplusBT&#39;&gt;
   insolation: &lt;class &#39;climlab.radiation.insolation.AnnualMeanInsolation&#39;&gt;
   albedo: &lt;class &#39;climlab.surface.albedo.StepFunctionAlbedo&#39;&gt;
      iceline: &lt;class &#39;climlab.surface.albedo.Iceline&#39;&gt;
      warm_albedo: &lt;class &#39;climlab.surface.albedo.P2Albedo&#39;&gt;
      cold_albedo: &lt;class &#39;climlab.surface.albedo.ConstantAlbedo&#39;&gt;
   SW: &lt;class &#39;climlab.radiation.absorbed_shorwave.SimpleAbsorbedShortwave&#39;&gt;
   diffusion: &lt;class &#39;climlab.dynamics.meridional_heat_diffusion.MeridionalHeatDiffusion&#39;&gt;

{&#39;timestep&#39;: 350632.51200000005, &#39;S0&#39;: 1365.2, &#39;s2&#39;: -0.48, &#39;A&#39;: 210.0, &#39;B&#39;: 2.0, &#39;D&#39;: 0.55, &#39;Tf&#39;: -10.0, &#39;water_depth&#39;: 10.0, &#39;a0&#39;: 0.3, &#39;a2&#39;: 0.078, &#39;ai&#39;: 0.62}
climlab Process of type &lt;class &#39;climlab.model.ebm.EBM_annual&#39;&gt;. 
State variables and domain shapes: 
  Ts: (180, 1) 
The subprocess tree: 
EBM with interactive ice line: &lt;class &#39;climlab.model.ebm.EBM_annual&#39;&gt;
   LW: &lt;class &#39;climlab.radiation.aplusbt.AplusBT&#39;&gt;
   insolation: &lt;class &#39;climlab.radiation.insolation.AnnualMeanInsolation&#39;&gt;
   albedo: &lt;class &#39;climlab.surface.albedo.StepFunctionAlbedo&#39;&gt;
      iceline: &lt;class &#39;climlab.surface.albedo.Iceline&#39;&gt;
      warm_albedo: &lt;class &#39;climlab.surface.albedo.P2Albedo&#39;&gt;
      cold_albedo: &lt;class &#39;climlab.surface.albedo.ConstantAlbedo&#39;&gt;
   SW: &lt;class &#39;climlab.radiation.absorbed_shorwave.SimpleAbsorbedShortwave&#39;&gt;
   diffusion: &lt;class &#39;climlab.dynamics.meridional_heat_diffusion.MeridionalHeatDiffusion&#39;&gt;

Integrating for 450 steps, 1826.2110000000002 days, or 5 years.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total elapsed time is 5.000000000000044 years.
Integrating for 450 steps, 1826.2110000000002 days, or 5 years.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total elapsed time is 9.999999999999863 years.
1.2815863495813735e-05
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-70.,  70.])
</pre></div>
</div>
<img alt="../_images/d01f75334df8b2f6be325cf48dd79367ba0555de3d0e0cdb3ded5a204c9d9f49.png" src="../_images/d01f75334df8b2f6be325cf48dd79367ba0555de3d0e0cdb3ded5a204c9d9f49.png" />
</div>
</div>
</section>
<section id="polar-amplified-warming-in-ebm-yeah">
<h2>Polar-amplified warming in EBM (Yeah!!!)<a class="headerlink" href="#polar-amplified-warming-in-ebm-yeah" title="Permalink to this heading">#</a></h2>
<p>If we consider a scenario of doubling CO2, that is to change paraemter <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(A-\delta A\)</span>, where <span class="math notranslate nohighlight">\(\delta A= 4\)</span> W/m<span class="math notranslate nohighlight">\(^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model1</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;LW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">A</span>

<span class="n">deltaA</span> <span class="o">=</span> <span class="mf">4.</span>

<span class="c1">#  This is a very handy way to &quot;clone&quot; an existing model:</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span>

<span class="c1">#  Now change the longwave parameter:</span>
<span class="n">model2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;LW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">deltaA</span>
<span class="c1">#  and integrate out to equilibrium again</span>
<span class="n">model2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model1</span><span class="o">.</span><span class="n">Ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model2</span><span class="o">.</span><span class="n">Ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">model2</span><span class="o">.</span><span class="n">icelat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-90.,  90.])
</pre></div>
</div>
<img alt="../_images/f85ae6562d9c76e2ac6e09ff39642b932bde27b25202cd5244a6771b1b3df878.png" src="../_images/f85ae6562d9c76e2ac6e09ff39642b932bde27b25202cd5244a6771b1b3df878.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model3</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span>
<span class="n">model3</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;LW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">deltaA</span>
<span class="n">model3</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model1</span><span class="o">.</span><span class="n">Ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model2</span><span class="o">.</span><span class="n">Ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model3</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model3</span><span class="o">.</span><span class="n">Ts</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;model3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x14635dc90&gt;
</pre></div>
</div>
<img alt="../_images/f4814fc95acf7ed8a9730e71bc3c30882ae5b4da3d234ee07d09f810f59437d9.png" src="../_images/f4814fc95acf7ed8a9730e71bc3c30882ae5b4da3d234ee07d09f810f59437d9.png" />
</div>
</div>
<p>For me, this is the minimal model to produce polar amplification. Starting from this model, I want to increase the model hierachy to study the drivers of polar mechanism.</p>
</section>
<section id="solar-forcing">
<h2>Solar forcing<a class="headerlink" href="#solar-forcing" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="o">**</span><span class="n">param</span><span class="p">)</span>
<span class="c1">#  The current (default) solar constant, corresponding to present-day conditions:</span>
<span class="n">m</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">S0</span>

<span class="c1">#  First, get to equilibrium</span>
<span class="n">m</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="c1">#  Check for energy balance</span>
<span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">icelat</span>

<span class="c1">#  Now make the solar constant smaller:</span>
<span class="n">m</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="mf">1300.</span>

<span class="c1">#  Integrate to new equilibrium</span>
<span class="n">m</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span>
<span class="c1">#  Check for energy balance</span>
<span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">icelat</span>

<span class="n">ebm_plot</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integrating for 450 steps, 1826.2110000000002 days, or 5.0 years.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total elapsed time is 5.000000000000044 years.
Integrating for 900 steps, 3652.4220000000005 days, or 10.0 years.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total elapsed time is 14.999999999999647 years.
</pre></div>
</div>
<img alt="../_images/c76cf7bb5754614e26ef9b09b986e32b842b025904cff6089a26682ee03e3f01.png" src="../_images/c76cf7bb5754614e26ef9b09b986e32b842b025904cff6089a26682ee03e3f01.png" />
</div>
</div>
</section>
<section id="the-effect-of-diffusivity-with-albedo-feedback">
<h2>The effect of diffusivity with albedo feedback<a class="headerlink" href="#the-effect-of-diffusivity-with-albedo-feedback" title="Permalink to this heading">#</a></h2>
<p>We repeat the results of <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/0377026578900064?via%3Dihub">Stone (1978)</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">210</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a0&#39;</span><span class="p">:</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">:</span><span class="mf">0.078</span><span class="p">,</span> <span class="s1">&#39;ai&#39;</span><span class="p">:</span><span class="mf">0.62</span><span class="p">,</span> <span class="s1">&#39;Tf&#39;</span><span class="p">:</span><span class="o">-</span><span class="mf">10.</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">param</span><span class="p">)</span>

<span class="n">Darray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="n">model_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Tmean_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">deltaT_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Hmax_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">Darray</span><span class="p">:</span>
    <span class="n">ebm</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">360</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="o">**</span><span class="n">param</span> <span class="p">)</span>
    <span class="n">ebm</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">Tmean</span> <span class="o">=</span> <span class="n">ebm</span><span class="o">.</span><span class="n">global_mean_temperature</span><span class="p">()</span>
    <span class="n">deltaT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ebm</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ebm</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span>
    <span class="n">HT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ebm</span><span class="o">.</span><span class="n">heat_transport</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ebm</span><span class="o">.</span><span class="n">lat_bounds</span><span class="o">==</span><span class="mf">35.5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Hmax</span> <span class="o">=</span> <span class="n">HT</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="n">model_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ebm</span><span class="p">)</span>
    <span class="n">Tmean_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tmean</span><span class="p">)</span>
    <span class="n">deltaT_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deltaT</span><span class="p">)</span>
    <span class="n">Hmax_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Hmax</span><span class="p">)</span>

<span class="n">color1</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
<span class="n">color2</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Darray</span><span class="p">,</span> <span class="n">deltaT_list</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Delta T$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Darray</span><span class="p">,</span> <span class="n">Tmean_list</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\overline</span><span class="si">{T}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;D (W m$^{-2}$ °C$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Darray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Darray</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>  <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
    <span class="n">tl</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Darray</span><span class="p">,</span> <span class="n">Hmax_list</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Poleward heat transport across 35.5° (PW)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tl</span> <span class="ow">in</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
    <span class="n">tl</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Effect of diffusivity on EBM with albedo feedback&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;A&#39;: 210, &#39;B&#39;: 2, &#39;a0&#39;: 0.3, &#39;a2&#39;: 0.078, &#39;ai&#39;: 0.62, &#39;Tf&#39;: -10.0}
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">13</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">Darray</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">ebm</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">360</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span> <span class="o">**</span><span class="n">param</span> <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">13</span>     <span class="n">ebm</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>     <span class="n">Tmean</span> <span class="o">=</span> <span class="n">ebm</span><span class="o">.</span><span class="n">global_mean_temperature</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">deltaT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ebm</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ebm</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/climlab/process/time_dependent_process.py:419,</span> in <span class="ni">TimeDependentProcess.integrate_years</span><span class="nt">(self, years, verbose)</span>
<span class="g g-Whitespace">    </span><span class="mi">416</span> <span class="c1">#  begin time loop</span>
<span class="g g-Whitespace">    </span><span class="mi">417</span> <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numsteps</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">418</span>     <span class="c1"># Compute the timestep</span>
<span class="ne">--&gt; </span><span class="mi">419</span>     <span class="bp">self</span><span class="o">.</span><span class="n">step_forward</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">420</span>     <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">421</span>         <span class="c1"># on first step only...</span>
<span class="g g-Whitespace">    </span><span class="mi">422</span>         <span class="c1">#  This implements a generic time-averaging feature</span>
<span class="g g-Whitespace">    </span><span class="mi">423</span>         <span class="c1"># using the list of model state variables</span>
<span class="g g-Whitespace">    </span><span class="mi">424</span>         <span class="bp">self</span><span class="o">.</span><span class="n">timeave</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/climlab/process/time_dependent_process.py:333,</span> in <span class="ni">TimeDependentProcess.step_forward</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">307</span> <span class="k">def</span> <span class="nf">step_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">308</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Updates state variables with computed tendencies.</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">310</span><span class="sd">     Calls the :func:`compute` method to get current tendencies for all</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">331</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">332</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">333</span>     <span class="n">tenddict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">334</span>     <span class="c1">#  Total tendency is applied as an explicit forward timestep</span>
<span class="nn">    335     # (already accounting properly for order of operations</span> in <span class="ni">compute</span><span class="nt">() )</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span>     <span class="k">for</span> <span class="n">varname</span><span class="p">,</span> <span class="n">tend</span> <span class="ow">in</span> <span class="n">tenddict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/climlab/process/time_dependent_process.py:220,</span> in <span class="ni">TimeDependentProcess.compute</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span>     <span class="n">var</span> <span class="o">+=</span> <span class="n">tendencies</span><span class="p">[</span><span class="s1">&#39;explicit&#39;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span> <span class="c1"># Now compute all implicit processes -- matrix inversions</span>
<span class="ne">--&gt; </span><span class="mi">220</span> <span class="n">tendencies</span><span class="p">[</span><span class="s1">&#39;implicit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_type</span><span class="p">(</span><span class="s1">&#39;implicit&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span> <span class="c1">#  Same deal ... temporarily apply tendencies from implicit step</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/climlab/process/time_dependent_process.py:261,</span> in <span class="ni">TimeDependentProcess._compute_type</span><span class="nt">(self, proctype)</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span> <span class="o">%</span> <span class="n">step_ratio</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>     <span class="n">proc</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;active_now&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">261</span>     <span class="n">tenddict</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>     <span class="c1"># proc.tendencies is unchanged from last subprocess timestep if we didn&#39;t recompute it above</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span>     <span class="n">proc</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;active_now&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/climlab/process/time_dependent_process.py:235,</span> in <span class="ni">TimeDependentProcess.compute</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span>         <span class="bp">self</span><span class="o">.</span><span class="n">tendencies</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">+=</span> <span class="n">tend</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span> <span class="c1"># Finally compute my own tendencies, if any</span>
<span class="ne">--&gt; </span><span class="mi">235</span> <span class="n">self_tend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">236</span> <span class="c1">#  Adjustment processes _compute method returns absolute adjustment</span>
<span class="g g-Whitespace">    </span><span class="mi">237</span> <span class="c1">#  Needs to be converted to rate of change</span>
<span class="g g-Whitespace">    </span><span class="mi">238</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_type</span> <span class="o">==</span> <span class="s1">&#39;adjustment&#39;</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/climlab/process/implicit.py:47,</span> in <span class="ni">ImplicitProcess._compute</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="k">def</span> <span class="nf">_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Computes the state variable tendencies in time for implicit processes.</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">26</span><span class="sd">     To calculate the new state the :func:`_implicit_solver()` method is</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">46</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">47</span>     <span class="n">newstate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_solver</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span>     <span class="n">adjustment</span> <span class="o">=</span> <span class="p">{}</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span>     <span class="n">tendencies</span> <span class="o">=</span> <span class="p">{}</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/climlab/dynamics/advection_diffusion.py:193,</span> in <span class="ni">AdvectionDiffusion._implicit_solver</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">191</span> <span class="k">for</span> <span class="n">varname</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">192</span>     <span class="n">field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">diffusion_axis_index</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">193</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">adv_diff_numerics</span><span class="o">.</span><span class="n">implicit_step_forward</span><span class="p">(</span><span class="n">field</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">194</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_advdiffTriDiag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">195</span>                 <span class="n">use_banded_solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_banded_solver</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span>     <span class="n">newstate</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">diffusion_axis_index</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">197</span> <span class="k">return</span> <span class="n">newstate</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/climlab/dynamics/adv_diff_numerics.py:428,</span> in <span class="ni">implicit_step_forward</span><span class="nt">(initial_field, tridiag, source, timestep, use_banded_solver)</span>
<span class="g g-Whitespace">    </span><span class="mi">426</span> <span class="n">I</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="n">inds_main</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">inds_main</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># stacked identity matrix</span>
<span class="g g-Whitespace">    </span><span class="mi">427</span> <span class="n">IminusTdt</span> <span class="o">=</span> <span class="n">I</span><span class="o">-</span><span class="n">tridiag</span><span class="o">*</span><span class="n">timestep</span>
<span class="ne">--&gt; </span><span class="mi">428</span> <span class="k">return</span> <span class="n">solve</span><span class="p">(</span><span class="n">IminusTdt</span><span class="p">,</span> <span class="n">RHS</span><span class="p">)</span>

<span class="nn">File &lt;__array_function__ internals&gt;:180,</span> in <span class="ni">solve</span><span class="nt">(*args, **kwargs)</span>

<span class="nn">File ~/miniconda3/lib/python3.11/site-packages/numpy/linalg/linalg.py:400,</span> in <span class="ni">solve</span><span class="nt">(a, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">signature</span> <span class="o">=</span> <span class="s1">&#39;DD-&gt;D&#39;</span> <span class="k">if</span> <span class="n">isComplexType</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;dd-&gt;d&#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span> <span class="n">extobj</span> <span class="o">=</span> <span class="n">get_linalg_error_extobj</span><span class="p">(</span><span class="n">_raise_linalgerror_singular</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">400</span> <span class="n">r</span> <span class="o">=</span> <span class="n">gufunc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">signature</span><span class="o">=</span><span class="n">signature</span><span class="p">,</span> <span class="n">extobj</span><span class="o">=</span><span class="n">extobj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span> <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">result_t</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>Stop here</p>
</section>
<section id="diffusive-response-to-a-point-source-of-energy-at-45-on">
<h2>Diffusive response to a point source of energy at 45<span class="math notranslate nohighlight">\(^o\)</span>N<a class="headerlink" href="#diffusive-response-to-a-point-source-of-energy-at-45-on" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>without albedo feedback</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_noalb</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">210</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span> <span class="s1">&#39;Tf&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;a0&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">:</span> <span class="mf">0.078</span><span class="p">}</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="o">**</span><span class="n">param_noalb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>

<span class="n">m1</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>

<span class="n">m2</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>

<span class="n">point_source</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">energy_budget</span><span class="o">.</span><span class="n">ExternalEnergySource</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">m2</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="n">m2</span><span class="o">.</span><span class="n">timestep</span><span class="p">)</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">lat</span> <span class="o">==</span> <span class="mf">45.5</span><span class="p">)</span>
<span class="n">point_source</span><span class="o">.</span><span class="n">heating_rate</span><span class="p">[</span><span class="s1">&#39;Ts&#39;</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.</span>

<span class="n">m2</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;point source&#39;</span><span class="p">,</span> <span class="n">point_source</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">m2</span><span class="p">)</span>

<span class="n">m2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">m2</span><span class="o">.</span><span class="n">Ts</span> <span class="o">-</span> <span class="n">m1</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta T_s$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The length scale of the point warming is suggested to be proportional to <span class="math notranslate nohighlight">\(\sqrt{\frac{D}{B}}\)</span></p>
</div>
<ul class="simple">
<li><p>with albedo</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m3</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="o">**</span><span class="n">param</span><span class="p">)</span>
<span class="n">m3</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="n">m4</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">m3</span><span class="p">)</span>
<span class="n">point_source</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">energy_budget</span><span class="o">.</span><span class="n">ExternalEnergySource</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">m4</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="n">m4</span><span class="o">.</span><span class="n">timestep</span><span class="p">)</span>
<span class="n">point_source</span><span class="o">.</span><span class="n">heating_rate</span><span class="p">[</span><span class="s1">&#39;Ts&#39;</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.</span>
<span class="n">m4</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;point source&#39;</span><span class="p">,</span> <span class="n">point_source</span><span class="p">)</span>
<span class="n">m4</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m4</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">m4</span><span class="o">.</span><span class="n">Ts</span> <span class="o">-</span> <span class="n">m3</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta T_s$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ice-cap-instability">
<h2>Ice cap instability<a class="headerlink" href="#ice-cap-instability" title="Permalink to this heading">#</a></h2>
<p>If we continue decreasing solar insolation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Now make the solar constant smaller:</span>
<span class="n">m</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="mf">1200.</span>
<span class="c1">#  First, get to equilibrium</span>
<span class="n">m</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="c1">#  Check for energy balance</span>
<span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span>
<span class="c1">#  Check for energy balance</span>
<span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">)</span>

<span class="n">ebm_plot</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">icelat</span>
</pre></div>
</div>
</div>
</div>
<p>If we now trun it back to present-day value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Now make the solar constant smaller:</span>
<span class="n">m</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="mf">1365.2</span>
<span class="c1">#  First, get to equilibrium</span>
<span class="n">m</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="c1">#  Check for energy balance</span>
<span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">)</span>

<span class="n">ebm_plot</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>What do you find?</p>
</section>
<section id="the-snowball-earth-hypothesis">
<h2>The snowball Earth hypothesis<a class="headerlink" href="#the-snowball-earth-hypothesis" title="Permalink to this heading">#</a></h2>
<p>Various bizarre features in the geological record from 635 and 715 Ma ago indicate that the Earth underwent some very extreme environmental change at least twice. The Snowball Earth hypothesis postulates that:</p>
<ul class="simple">
<li><p>The Earth was completely ice-covered (including the oceans)</p></li>
<li><p>The total glaciation endured for millions of years</p></li>
<li><p>CO2 slowly accumulated in the atmosphere from volcanoes</p></li>
<li><p>Weathering of rocks (normally acting to reduce CO2) extremely slow due to cold, dry climate</p></li>
<li><p>Eventually the extreme greenhouse effect is enough to melt back the ice</p></li>
<li><p>The Earth then enters a period of extremely hot climate.</p></li>
</ul>
<p>The hypothesis rests on a phenomenon first discovered by climate modelers in the Budyko-Sellers EBM: runaway ice-albedo feedback or large ice cap instability.</p>
</section>
<section id="hysteresis-in-ebm">
<h2>Hysteresis in EBM<a class="headerlink" href="#hysteresis-in-ebm" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">num_lat</span> <span class="o">=</span> <span class="mi">360</span><span class="p">,</span> <span class="o">**</span><span class="n">param</span><span class="p">)</span>
<span class="n">S0array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1400.</span><span class="p">,</span> <span class="mf">1200.</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">model2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">icelat_cooling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">S0array</span><span class="p">)</span>
<span class="n">icelat_warming</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">S0array</span><span class="p">)</span>
<span class="c1"># First cool....</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S0array</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="n">model2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;insolation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="n">S0array</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">model2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">icelat_cooling</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">icelat</span><span class="p">)</span>
<span class="c1"># Then warm...</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S0array</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="n">model2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;insolation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">S0array</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">model2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">icelat_warming</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">icelat</span><span class="p">)</span>
<span class="c1"># For completeness -- also start from present-day conditions and warm up.</span>
<span class="n">model3</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">360</span><span class="p">,</span> <span class="o">**</span><span class="n">param</span><span class="p">)</span>
<span class="n">S0array3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1350.</span><span class="p">,</span> <span class="mf">1400.</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">icelat3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">S0array3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S0array3</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="n">model3</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;insolation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="n">S0array3</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">model3</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">icelat3</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">model3</span><span class="o">.</span><span class="n">icelat</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S0array</span><span class="p">,</span> <span class="n">icelat_cooling</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cooling&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S0array</span><span class="p">,</span> <span class="n">icelat_warming</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;warming&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S0array3</span><span class="p">,</span> <span class="n">icelat3</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;warming&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Ice edge latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Solar constant (W m$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">S0</span><span class="p">,</span> <span class="n">const</span><span class="o">.</span><span class="n">S0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;present-day&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Solar constant versus ice edge latitude in the EBM with albedo feedback&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Three climate states could happen under present-day solar radiation!</p>
<p>Now let’s trun it back:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>

<span class="n">model4</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">model2</span><span class="p">)</span>  <span class="c1"># initialize with cold Snowball temperature</span>
<span class="n">model4</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;insolation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="mf">1830.</span>
<span class="n">model4</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model4</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model4</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">my_ticks</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The ice edge is at &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">model4</span><span class="o">.</span><span class="n">icelat</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; degrees latitude.&#39;</span> <span class="p">)</span>

<span class="n">model4</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;insolation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="mf">1840.</span>
<span class="n">model4</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model4</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model4</span><span class="o">.</span><span class="n">Ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">my_ticks</span><span class="p">);</span>

<span class="n">model4</span><span class="o">.</span><span class="n">global_mean_temperature</span><span class="p">()</span>

<span class="n">S0array_snowballmelt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1400.</span><span class="p">,</span> <span class="mf">1900.</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">icelat_snowballmelt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">S0array_snowballmelt</span><span class="p">)</span>
<span class="n">icelat_snowballmelt_cooling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">S0array_snowballmelt</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S0array_snowballmelt</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="n">model2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;insolation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="n">S0array_snowballmelt</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">model2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">icelat_snowballmelt</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">icelat</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S0array_snowballmelt</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="n">model2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;insolation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">S0array_snowballmelt</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">model2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">icelat_snowballmelt_cooling</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">icelat</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S0array</span><span class="p">,</span> <span class="n">icelat_cooling</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cooling&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S0array</span><span class="p">,</span> <span class="n">icelat_warming</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;warming&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S0array3</span><span class="p">,</span> <span class="n">icelat3</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;warming&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S0array_snowballmelt</span><span class="p">,</span> <span class="n">icelat_snowballmelt</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S0array_snowballmelt</span><span class="p">,</span> <span class="n">icelat_snowballmelt_cooling</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Ice edge latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Solar constant (W m$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">S0</span><span class="p">,</span> <span class="n">const</span><span class="o">.</span><span class="n">S0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;present-day&#39;</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Solar constant versus ice edge latitude in the EBM with albedo feedback&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="homework-assignment-x-due-xxx">
<h2>Homework assignment X (due xxx)<a class="headerlink" href="#homework-assignment-x-due-xxx" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Solar forcing. Please change the solar forcing and discuss the results.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">EBM_annual</span><span class="p">(</span><span class="n">num_lat</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="o">**</span><span class="n">param</span><span class="p">)</span>
<span class="c1">#  The current (default) solar constant, corresponding to present-day conditions:</span>
<span class="n">m</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">S0</span>

<span class="c1">#  First, get to equilibrium</span>
<span class="n">m</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
<span class="c1">#  Check for energy balance</span>
<span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">icelat</span>

<span class="c1">#  Now make the solar constant smaller:</span>
<span class="n">m</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">S0</span> <span class="o">=</span> <span class="mf">1300.</span>

<span class="c1">#  Integrate to new equilibrium</span>
<span class="n">m</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span>
<span class="c1">#  Check for energy balance</span>
<span class="n">climlab</span><span class="o">.</span><span class="n">global_mean</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">net_radiation</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">icelat</span>

<span class="n">ebm_plot</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-ice-snow-line-step-function">Interactive ice/snow line (step function)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polar-amplified-warming-in-ebm-yeah">Polar-amplified warming in EBM (Yeah!!!)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solar-forcing">Solar forcing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-effect-of-diffusivity-with-albedo-feedback">The effect of diffusivity with albedo feedback</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusive-response-to-a-point-source-of-energy-at-45-on">Diffusive response to a point source of energy at 45<span class="math notranslate nohighlight">\(^o\)</span>N</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ice-cap-instability">Ice cap instability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-snowball-earth-hypothesis">The snowball Earth hypothesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hysteresis-in-ebm">Hysteresis in EBM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homework-assignment-x-due-xxx">Homework assignment X (due xxx)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yu-Chiao Liang
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>